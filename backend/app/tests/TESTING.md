# Документация по тестированию Books Portal

## Содержание
1. [Обзор](#обзор)
2. [Виды тестирования](#виды-тестирования)
   - [Модульное тестирование](#модульное-тестирование)
   - [Интеграционное тестирование](#интеграционное-тестирование)
   - [Тестирование безопасности](#тестирование-безопасности)
   - [Нагрузочное тестирование](#нагрузочное-тестирование)
3. [Инфраструктура тестирования](#инфраструктура-тестирования)
4. [Запуск тестов](#запуск-тестов)
5. [Отчетность](#отчетность)

## Обзор

В проекте Books Portal реализована комплексная система тестирования, охватывающая различные аспекты приложения. Система тестирования включает в себя модульные, интеграционные, нагрузочные тесты и тесты безопасности.

## Виды тестирования

### Модульное тестирование

Модульные тесты расположены в директории `unit/` и проверяют отдельные компоненты системы в изоляции.

Основные тестируемые компоненты:
- Модели данных (`test_models.py`)
  - Создание и валидация пользователей
  - Создание и связи книг
  - Работа с категориями и тегами
- Аутентификация (`test_auth.py`)
  - Вход пользователей
  - Обработка неверных учетных данных
- API книг (`test_books.py`)
  - CRUD операции с книгами
  - Валидация данных
  - Обработка ошибок

### Интеграционное тестирование

Интеграционные тесты находятся в директории `integration/` и проверяют взаимодействие различных компонентов системы.

Основные тестируемые сценарии:
- Полный цикл работы с книгой
- Взаимодействие с базой данных
- Обработка ошибок API
- Работа с JWT токенами
- Интеграция с внешними сервисами

### Тестирование безопасности

Тесты безопасности расположены в директории `security/` и проверяют защищенность приложения.

Проверяемые аспекты:
- Валидация JWT токенов
- Контроль доступа к защищенным ресурсам
- Обработка неверных форматов токенов
- Проверка прав доступа для разных ролей пользователей
- Защита от несанкционированного доступа

### Нагрузочное тестирование

Нагрузочные тесты находятся в директории `load/` и используют инструмент Locust для тестирования производительности.

Тестируемые сценарии:
- Работа обычных пользователей
- Работа модераторов
- Параллельные запросы
- Обработка большого количества данных
- Проверка производительности API

## Инфраструктура тестирования

### Фикстуры и конфигурация
- `conftest.py` - основные фикстуры для тестов
- Тестовая база данных PostgreSQL
- Асинхронный HTTP клиент для тестирования API
- Мок-объекты и тестовые данные

### Инструменты
- pytest - основной фреймворк тестирования
- httpx - для асинхронных HTTP запросов
- Locust - для нагрузочного тестирования
- SQLAlchemy - для работы с тестовой базой данных

## Запуск тестов

### Запуск всех тестов
```bash
python -m pytest
```

### Запуск конкретных типов тестов
```bash
# Модульные тесты
python -m pytest tests/unit/

# Интеграционные тесты
python -m pytest tests/integration/

# Тесты безопасности
python -m pytest tests/security/

# Нагрузочные тесты
locust -f tests/load/locustfile.py
```

### Запуск через test_runner.py
```bash
python tests/test_runner.py
```

## Отчетность

Система автоматически генерирует отчеты о тестировании, включающие:
- Статистику по типам тестов
- Процент успешных тестов
- Время выполнения
- Детали ошибок
- Отчеты о покрытии кода

Отчеты доступны в:
- Консоли после выполнения тестов
- Директории `htmlcov/` (для отчетов о покрытии кода)
- Логах в директории `logs/`
